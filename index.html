<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Misi Kelasku - Pak Ryan</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        :root { 
            --primary: #2563eb; 
            --it-color: #7c3aed; 
            --ipa-color: #059669; 
            --bg: #f1f5f9; 
        }

        body { 
            font-family: 'Quicksand', sans-serif; 
            background-color: var(--bg); 
            margin: 0; 
            color: #1e293b; 
        }

        /* Teks Berjalan */
        .marquee-container {
            background: linear-gradient(90deg, var(--primary), var(--it-color));
            color: white;
            padding: 10px 0;
            font-weight: 600;
            font-size: 0.85rem;
            position: sticky;
            top: 0;
            z-index: 1001;
        }

        nav { 
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 15px 5%; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 40px;
            z-index: 1000;
        }

        .logo { font-weight: 700; font-size: 1.5rem; color: var(--primary); }

        .page { display: none; padding: 25px 5%; max-width: 850px; margin: auto; animation: slideUp 0.5s ease; }
        .active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .profile-card {
            text-align: center; background: white; padding: 30px; border-radius: 30px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05); margin-bottom: 30px;
        }

        .profile-img { width: 120px; height: 120px; border-radius: 50%; border: 4px solid #e2e8f0; object-fit: cover; }

        .grid-menu { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .btn-menu { 
            padding: 25px; border-radius: 20px; color: white; border: none; 
            font-weight: 700; cursor: pointer; transition: 0.3s;
        }
        .btn-menu:hover { transform: translateY(-5px); filter: brightness(1.1); }
        .bg-it { background: linear-gradient(135deg, #a855f7, #7c3aed); }
        .bg-ipa { background: linear-gradient(135deg, #10b981, #059669); }

        .card { background: white; padding: 25px; border-radius: 25px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 25px; }

        /* Style Dropdown & Link */
        .dropdown { margin-bottom: 10px; border: 1px solid #f1f5f9; border-radius: 15px; overflow: hidden; background: #f8fafc; }
        .dropdown-header { padding: 15px; cursor: pointer; font-weight: 700; display: flex; justify-content: space-between; }
        .dropdown-content { display: none; padding: 10px; background: white; }
        .dropdown.active .dropdown-content { display: block; }
        .dropdown.active .dropdown-header { color: var(--primary); background: #f0f7ff; }

        .file-link { 
            display: flex; justify-content: space-between; align-items: center;
            padding: 12px 15px; text-decoration: none; color: #475569; 
            border-radius: 10px; font-size: 0.85rem; margin-bottom: 5px; 
            background: #f1f5f9; transition: 0.2s; 
        }
        .file-link:hover { background: #e0e7ff; color: var(--primary); }

        .status-badge { font-size: 0.65rem; padding: 3px 8px; border-radius: 5px; font-weight: bold; }
        .badge-none { background: #fee2e2; color: #dc2626; }
        .badge-ready { background: #dcfce7; color: #16a34a; }

        input { width: 100%; padding: 15px; border: 2px solid #e2e8f0; border-radius: 12px; margin-bottom: 15px; font-family: inherit; box-sizing: border-box; }
        .btn-action { width: 100%; padding: 15px; background: var(--primary); color: white; border: none; border-radius: 12px; font-weight: 700; cursor: pointer; }
        
        .mission-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 10px; margin-top: 15px; }
        .mission-item { background: #f8fafc; padding: 10px; border-radius: 12px; text-align: center; border: 1px solid #e2e8f0; }
    </style>
</head>
<body>

<div class="marquee-container">
    <marquee scrollamount="5">üì¢ PENGUMUMAN: Selesaikan Misi Belajar tepat waktu! | üíª Informatika 7: Materi Excel Baru Sudah Tersedia | üî¨ IPA 8: Siapkan laporan Praktikum Unit 1!</marquee>
</div>

<nav>
    <div class="logo">Misi Kelasku</div>
    <button onclick="showPage('home')" style="background:none; border:none; color:var(--primary); font-weight:700; cursor:pointer;">üè† Beranda</button>
</nav>

<div id="home" class="page active">
    <div class="profile-card">
        <img src="https://lh3.googleusercontent.com/a/ACg8ocISlYB84_3-3T-X9ovOzTkV7FglYncsPtpNQ3gW4AjQrh-GMMyT=s241-c-no" alt="Pak Ryan" class="profile-img">
        <h2 style="margin: 15px 0 5px 0;">Halo Semuanya, Saya Pak Ryan üëã</h2>
        <p style="color: #64748b; margin: 0;">Guru Informatika & IPA. Siap menuntaskan misi belajar hari ini?</p>
    </div>
    <div class="grid-menu">
        <button class="btn-menu bg-it" onclick="showPage('it-page')">üíª INFORMATIKA 7</button>
        <button class="btn-menu bg-ipa" onclick="showPage('ipa-page')">üî¨ IPA 8</button>
    </div>
</div>

<div id="it-page" class="page">
    <div class="card">
        <h2 style="margin-top:0">üìÇ Peta Materi Informatika 7</h2>
        
        <div class="dropdown">
            <div class="dropdown-header" onclick="toggleDropdown(this)">BAB 1. MICROSOFT EXCEL <span>‚ñº</span></div>
            <div class="dropdown-content">
                <a href="#" id="it1-1" class="file-link">P1. Pengenalan MS Excel</a>
                <a href="#" id="it1-2" class="file-link">P2. Input Data di Excel</a>
                <a href="#" id="it1-3" class="file-link">P3. Format Data Excel</a>
                <a href="#" id="it1-4" class="file-link">P4. Rumus Dasar (SUM, AVG, dll)</a>
                <a href="#" id="it1-5" class="file-link">P5. Sort & Filter Data</a>
                <a href="#" id="it1-6" class="file-link">P6. Membuat Grafik</a>
                <a href="#" id="it1-7" class="file-link">P7. Sumatif (Proyek MINI)</a>
                <a href="#" id="it1-8" class="file-link">P8. Lanjutan Proyek</a>
                <a href="#" id="it1-9" class="file-link">P9. Evaluasi Bab 1</a>
            </div>
        </div>

        <div class="dropdown">
            <div class="dropdown-header" onclick="toggleDropdown(this)">BAB 2. SISTEM BILANGAN BINER <span>‚ñº</span></div>
            <div class="dropdown-content">
                <a href="#" id="it2-1" class="file-link">P1. Pengenalan Bilangan Biner</a>
                <a href="#" id="it2-2" class="file-link">P2. Desimal ke Biner</a>
                <a href="#" id="it2-3" class="file-link">P3. Biner ke Desimal</a>
                <a href="#" id="it2-4" class="file-link">P4. Penerapan Bilangan Biner</a>
                <a href="#" id="it2-5" class="file-link">P5. Sumatif Bab 2</a>
            </div>
        </div>

        <div class="dropdown">
            <div class="dropdown-header" onclick="toggleDropdown(this)">BAB 3. WEB BROWSER & SEARCH ENGINE <span>‚ñº</span></div>
            <div class="dropdown-content">
                <a href="#" id="it3-1" class="file-link">P1. Pengenalan Internet & Browser</a>
                <a href="#" id="it3-2" class="file-link">P2. Praktek Web Browser</a>
                <a href="#" id="it3-3" class="file-link">P3. Search Engine & Kata Kunci</a>
                <a href="#" id="it3-4" class="file-link">P4. Informasi Valid & Hoax</a>
                <a href="#" id="it3-5" class="file-link">P5. Sumatif Bab 3</a>
            </div>
        </div>

        <div class="dropdown">
            <div class="dropdown-header" onclick="toggleDropdown(this)">BAB 4. DAMPAK PERUNDUNGAN DIGITAL <span>‚ñº</span></div>
            <div class="dropdown-content">
                <a href="#" id="it4-1" class="file-link">P1. Pengertian & Dampak</a>
                <a href="#" id="it4-2" class="file-link">P2. Proyek Akhir Poster</a>
            </div>
        </div>
    </div>

    <div class="card">
        <h3>üîç Cek Progres Informatika 7</h3>
        <input type="text" id="inputIT" placeholder="Ketik Nama Lengkap...">
        <button class="btn-action" onclick="fetchData('7', 'inputIT', 'resIT')">Cari Misi</button>
        <div id="resIT"></div>
    </div>
</div>

<div id="ipa-page" class="page">
    <div class="card">
        <h2 style="margin-top:0">üìÇ Peta Materi IPA 8</h2>

        <div class="dropdown">
            <div class="dropdown-header" onclick="toggleDropdown(this)">UNIT 1. ZAT DI SEKITAR KITA <span>‚ñº</span></div>
            <div class="dropdown-content">
                <a href="#" id="ipa1-1" class="file-link">P1. Mengenal Zat</a>
                <a href="#" id="ipa1-2" class="file-link">P2. Mengelompokkan Zat</a>
                <a href="#" id="ipa1-3" class="file-link">P3. Unsur, Senyawa, Campuran</a>
                <a href="#" id="ipa1-4" class="file-link">P4. Perubahan Zat</a>
                <a href="#" id="ipa1-5" class="file-link">P5. Praktikum Zat</a>
                <a href="#" id="ipa1-6" class="file-link">P6. Sumatif Unit 1</a>
            </div>
        </div>

        <div class="dropdown">
            <div class="dropdown-header" onclick="toggleDropdown(this)">UNIT 2. GETARAN DAN GELOMBANG <span>‚ñº</span></div>
            <div class="dropdown-content">
                <a href="#" id="ipa2-1" class="file-link">P1. Getaran</a>
                <a href="#" id="ipa2-2" class="file-link">P2. Gelombang</a>
                <a href="#" id="ipa2-3" class="file-link">P3. Latihan Soal</a>
                <a href="#" id="ipa2-4" class="file-link">P4. Video Materi Online</a>
                <a href="" id="ipa2-5" class="file-link">P5-6. Studi Kasus</a>
                <a href="#" id="ipa2-7" class="file-link">P7. Sumatif Unit 2</a>
            </div>
        </div>

        <div class="dropdown">
            <div class="dropdown-header" onclick="toggleDropdown(this)">UNIT 3. STRUKTUR BUMI & DAMPAKNYA <span>‚ñº</span></div>
            <div class="dropdown-content">
                <a href="#" id="ipa3-1" class="file-link">P1. Mengenal Bumi</a>
                <a href="#" id="ipa3-2" class="file-link">P2. Struktur Lapisan Bumi</a>
                <a href="#" id="ipa3-3" class="file-link">P3. Dinamika Bumi</a>
                <a href="#" id="ipa3-4" class="file-link">P4. Dampak Struktur Bumi</a>
                <a href="#" id="ipa3-5" class="file-link">P5. Mitigasi Bencana</a>
                <a href="#" id="ipa3-6" class="file-link">P6. Praktikum</a>
                <a href="#" id="ipa3-7" class="file-link">P7. Latihan Soal</a>
            </div>
        </div>
    </div>

    <div class="card">
        <h3>üîç Cek Progres IPA 8</h3>
        <input type="text" id="inputIPA" placeholder="Ketik Nama Lengkap...">
        <button class="btn-action" onclick="fetchData('8', 'inputIPA', 'resIPA')">Cari Misi</button>
        <div id="resIPA"></div>
    </div>
</div>

<script>
    // MASUKKAN LINK GOOGLE DRIVE DI SINI
    const linkMateri = {
        "it1-1": "https://docs.google.com/presentation/d/1fBfAi93FaBsx7ff4eTg4o7mWAekkVHUW/edit?usp=sharing&ouid=116310823270248933223&rtpof=true&sd=true", "it1-2": "#", "it1-3": "#", "it1-4": "#", "it1-5": "#", "it1-6": "#", "it1-7": "#", "it1-8": "#", "it1-9": "#",
        "it2-1": "#", "it2-2": "#", "it2-3": "#", "it2-4": "#", "it2-5": "#",
        "it3-1": "#", "it3-2": "#", "it3-3": "#", "it3-4": "#", "it3-5": "#",
        "it4-1": "#", "it4-2": "#",
        "ipa1-1": "https://docs.google.com/presentation/d/18SUIzpYejApGT4BdcrM6whBRC8oqqQER/edit?usp=sharing&ouid=116310823270248933223&rtpof=true&sd=true", "ipa1-2": "https://docs.google.com/presentation/d/18SUIzpYejApGT4BdcrM6whBRC8oqqQER/edit?usp=drive_link&ouid=116310823270248933223&rtpof=true&sd=true", "ipa1-3": "#", "ipa1-4": "#", "ipa1-5": "#", "ipa1-6": "https://drive.google.com/file/d/1FXF9RNyX7EcFqkzhhL7PgUGIzZM6INgs/view?usp=drive_link",
        "ipa2-1": "https://docs.google.com/presentation/d/1sLbJyKECeCHUHFKJtWyjJeejI3uIbBnp/edit?usp=drive_link&ouid=116310823270248933223&rtpof=true&sd=true", "ipa2-2": "https://docs.google.com/presentation/d/1PH2Q84eyLKfZ4UkBEt_olh6WgnQwvBs0/edit?usp=drive_link&ouid=116310823270248933223&rtpof=true&sd=true", "ipa2-3": "https://drive.google.com/drive/folders/1fF9N-UtQUhHtYxAa64uKc_COhV_Vv9zq?usp=drive_link", "ipa2-4": "https://www.youtube.com/watch?v=x1x71WPgy8I&pp=ygUrcGVuZXJhcGFuIGdldGFyYW4gZGFuIGdlbG9tYmFuZyBzbXAga2VsYXMgOA%3D%3D", "ipa2-5": "https://drive.google.com/drive/folders/1ujUmX3iwLuyPl9MTqFrEq4JAFsQ1afJg?usp=drive_link", "ipa2-7": "#",
        "ipa3-1": "https://drive.google.com/drive/folders/12QHPQDPTA-NRmy9T1cPi3Gz_rx1HZJ8s?usp=drive_link", "ipa3-2": "https://drive.google.com/drive/folders/1x_OJQjvL5T32xiC1_fqZjcxYX396E4Px?usp=drive_link", "ipa3-3": "https://drive.google.com/drive/folders/1dl4p9i2N-iOCsIUC6CsCCIkhEh3vPpfn?usp=drive_link", "ipa3-4": "https://drive.google.com/drive/folders/1ASDEYjIz-mm57m4I_Oa0PjFmmSOffsEH?usp=drive_link", "ipa3-5": "https://drive.google.com/drive/folders/1to9Bfh8vRreJbNx4Nrflc_Ybjcg-Eqng?usp=drive_link", "ipa3-6": "https://drive.google.com/drive/folders/1UFllR1zaeUkOagul_R92ifOo_TpLXLQ4?usp=drive_link", "ipa3-7": "https://drive.google.com/drive/folders/1q7Lw2ZkSWrd2weTAaa8CyBGUdOVdkewa?usp=drive_link"
    };

    window.onload = function() {
        for (let id in linkMateri) {
            let el = document.getElementById(id);
            if (el) {
                if (linkMateri[id] !== "#") {
                    el.href = linkMateri[id];
                    el.target = "_blank";
                    el.innerHTML += " <span class='status-badge badge-ready'>Tersedia</span>";
                } else {
                    el.innerHTML += " <span class='status-badge badge-none'>Belum Ada</span>";
                    el.onclick = function(e) { 
                        e.preventDefault(); 
                        Swal.fire({
                            title: 'Materi Belum Tersedia',
                            text: 'Sabar ya! Pak Ryan sedang menyiapkan materi ini.',
                            icon: 'info',
                            confirmButtonText: 'Oke, Pak!'
                        });
                    };
                }
            }
        }
    };

    function showPage(id) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        window.scrollTo(0,0);
    }

    function toggleDropdown(header) {
        header.parentElement.classList.toggle('active');
    }

    const SHEET_URL = 'https://docs.google.com/spreadsheets/d/1SapIaWzFLWmHeh3Vqc0AV6BB0YBqZ2NB1HTWv6-LuoQ/edit?usp=sharing';

    function fetchData(sheetName, inputId, resultId) {
        const nameInput = document.getElementById(inputId).value.toUpperCase();
        const resDiv = document.getElementById(resultId);
        if(!nameInput) return Swal.fire('Peringatan', 'Ketik namamu dulu!', 'warning');

        resDiv.innerHTML = "<p style='text-align:center'>‚è≥ Mencari datamu...</p>";
        const query = encodeURIComponent(`SELECT * WHERE B CONTAINS '${nameInput}'`);
        const url = SHEET_URL.replace('/edit', `/gviz/tq?tq=${query}&sheet=${sheetName}&t=${new Date().getTime()}`);

        fetch(url).then(r => r.text()).then(t => {
            const j = JSON.parse(t.substr(47).slice(0, -2));
            const rows = j.table.rows;
            const cols = j.table.cols;

            if(rows.length > 0) {
                const rowData = rows[0].c;
                let grid = `<div class="mission-grid">`;
                for(let i = 2; i < rowData.length; i++) {
                    if(!cols[i] || !cols[i].label) continue;
                    let val = rowData[i] ? rowData[i].v : "";
                    let isTuntas = (val === '‚úì' || val === 'v' || val === 'V');
                    grid += `<div class="mission-item">
                        <small style="font-weight:600; color:#64748b;">${cols[i].label}</small><br>
                        ${isTuntas ? '<b style="color:green">‚úÖ TUNTAS</b>' : '<b style="color:red">‚ùå BELUM</b>'}
                    </div>`;
                }
                grid += `</div>`;
                resDiv.innerHTML = `
                <div style="background:#f0f9ff; padding:20px; border-radius:15px; border-left:5px solid #2563eb; margin-top:15px">
                    <p style="margin:0"><b>Nama:</b> ${rowData[1].v}</p>
                    ${grid}
                </div>`;
            } else {
                resDiv.innerHTML = "<p style='color:red; text-align:center;'>Nama tidak ditemukan!</p>";
            }
        }).catch(e => {
            resDiv.innerHTML = "Database tidak terjangkau.";
        });
    }
</script>
</body>
</html>